% CHAPTER 7: LISTS
% ============================================================================

\chapter{Lists}
\label{ch:lists}

Lists are collections of values stored in a single variable. BCL provides comprehensive list manipulation commands.

\section{Creating Lists}

\subsection{LIST Command}

\begin{examplebox}[title=Creating Lists]
\begin{lstlisting}[language=BCL]
SET numbers [LIST 1 2 3 4 5]
SET colors [LIST red green blue]
SET mixed [LIST "hello world" 42 3.14]

PUTS $numbers
PUTS $colors
\end{lstlisting}

\textbf{Output:}
\begin{verbatim}
1 2 3 4 5
red green blue
\end{verbatim}
\end{examplebox}

\subsection{SPLIT Command}

\cmd{SPLIT} creates a list by splitting a string on a separator.

\begin{examplebox}[title=Splitting Strings]
\begin{lstlisting}[language=BCL]
SET csv "apple,banana,cherry,date"
SET fruits [SPLIT $csv ","]

FOREACH fruit IN $fruits DO
  PUTS "Fruit: $fruit"
END
\end{lstlisting}

\textbf{Output:}
\begin{verbatim}
Fruit: apple
Fruit: banana
Fruit: cherry
Fruit: date
\end{verbatim}
\end{examplebox}

\section{Accessing List Elements}

\subsection{LINDEX: Get Element by Index}

\begin{examplebox}[title=Accessing Elements]
\begin{lstlisting}[language=BCL]
SET names [LIST Alice Bob Charlie Diana]

SET first [LINDEX $names 0]
SET second [LINDEX $names 1]
SET last [LINDEX $names 3]

PUTS "First: $first"
PUTS "Second: $second"
PUTS "Last: $last"

# To get the last element, calculate the index
SET len [LLENGTH $names]
SET last_elem [LINDEX $names [EXPR $len - 1]]
PUTS "Last element: $last_elem"
\end{lstlisting}

\textbf{Output:}
\begin{verbatim}
First: Alice
Second: Bob
Last: Diana
Last element: Diana
\end{verbatim}
\end{examplebox}

\begin{notebox}
\textbf{Limitation:} Negative indices (e.g., \texttt{-1} for last element) are not currently supported. Use \cmd{LLENGTH} and positive indices as shown above.
\end{notebox}

\subsection{LRANGE: Get Sublist}

\begin{examplebox}[title=Extracting Sublists]
\begin{lstlisting}[language=BCL]
SET numbers [LIST 10 20 30 40 50 60]

SET first_three [LRANGE $numbers 0 2]
SET last_two [LRANGE $numbers 4 5]
SET middle [LRANGE $numbers 2 4]

PUTS "First three: $first_three"
PUTS "Last two: $last_two"
PUTS "Middle: $middle"
\end{lstlisting}

\textbf{Output:}
\begin{verbatim}
First three: 10 20 30
Last two: 50 60
Middle: 30 40 50
\end{verbatim}
\end{examplebox}

\subsection{LLENGTH: Get List Length}

\begin{examplebox}[title=List Length]
\begin{lstlisting}[language=BCL]
SET items [LIST pen paper pencil eraser]
SET count [LLENGTH $items]

PUTS "The list has $count items"

# Iterate using length
SET i 0
WHILE $i < $count DO
  SET item [LINDEX $items $i]
  PUTS "Item $i: $item"
  INCR i
END
\end{lstlisting}
\end{examplebox}

\section{Modifying Lists}

\subsection{LAPPEND: Add to End}

\cmd{LAPPEND} modifies the variable in-place by appending elements to it. The variable is updated directly and the new value is also returned.

\textbf{Syntax:}
\begin{lstlisting}[language=BCL]
LAPPEND varname element ?element ...?
\end{lstlisting}

\textbf{Note:} Unlike some list commands, LAPPEND modifies the variable directly -- you don't need to reassign the result.

\begin{examplebox}[title=Appending to Lists]
\begin{lstlisting}[language=BCL]
SET fruits [LIST apple banana]

# LAPPEND modifies fruits directly
LAPPEND fruits cherry
LAPPEND fruits date elderberry

PUTS $fruits
# Output: apple banana cherry date elderberry

# You can also capture the return value if needed
SET result [LAPPEND fruits fig]
PUTS "Returned: $result"
PUTS "Variable: $fruits"
\end{lstlisting}

\textbf{Output:}
\begin{verbatim}
apple banana cherry date elderberry
Returned: apple banana cherry date elderberry fig
Variable: apple banana cherry date elderberry fig
\end{verbatim}
\end{examplebox}

\subsection{LINSERT: Insert at Position}

\begin{examplebox}[title=Inserting Elements]
\begin{lstlisting}[language=BCL]
SET numbers [LIST 1 2 4 5]
# Insert 3 at index 2
SET numbers [LINSERT $numbers 2 3]

PUTS $numbers  # Prints: 1 2 3 4 5
\end{lstlisting}
\end{examplebox}

\subsection{LREPLACE: Replace Range}

\begin{examplebox}[title=Replacing Elements]
\begin{lstlisting}[language=BCL]
SET letters [LIST a b c d e]

# Replace index 1-2 with X Y
SET letters [LREPLACE $letters 1 2 X Y]
PUTS $letters  # Prints: a X Y d e

# Delete elements (no replacement)
SET letters [LREPLACE $letters 1 2]
PUTS $letters  # Prints: a d e
\end{lstlisting}
\end{examplebox}

\section{Sorting and Searching}

\subsection{LSORT: Sort Lists}

\begin{examplebox}[title=Sorting]
\begin{lstlisting}[language=BCL]
SET unsorted [LIST zebra apple monkey dog cat]
SET sorted [LSORT $unsorted]

PUTS "Unsorted: $unsorted"
PUTS "Sorted: $sorted"
\end{lstlisting}

\textbf{Output:}
\begin{verbatim}
Unsorted: zebra apple monkey dog cat
Sorted: apple cat dog monkey zebra
\end{verbatim}
\end{examplebox}

\begin{notebox}
\cmd{LSORT} performs ASCII sorting, which is case-sensitive. Uppercase letters come before lowercase.
\end{notebox}

\subsection{LSEARCH: Find Element}

\begin{examplebox}[title=Searching Lists]
\begin{lstlisting}[language=BCL]
SET fruits [LIST apple banana cherry date]

SET idx1 [LSEARCH $fruits "banana"]
SET idx2 [LSEARCH $fruits "grape"]

PUTS "Index of banana: $idx1"  # 1
PUTS "Index of grape: $idx2"   # -1 (not found)

IF $idx1 != -1 THEN
  PUTS "Found banana at position $idx1"
END
\end{lstlisting}
\end{examplebox}

\section{List Operations}

\subsection{JOIN: List to String}

\begin{examplebox}[title=Joining Lists]
\begin{lstlisting}[language=BCL]
SET words [LIST Hello World from BCL]

SET sentence [JOIN $words " "]
SET csv [JOIN $words ","]

PUTS $sentence  # Hello World from BCL
PUTS $csv       # Hello,World,from,BCL
\end{lstlisting}
\end{examplebox}

\subsection{CONCAT: Combine Lists}

\begin{examplebox}[title=Concatenating Lists]
\begin{lstlisting}[language=BCL]
SET list1 [LIST 1 2 3]
SET list2 [LIST 4 5 6]
SET list3 [LIST 7 8 9]

SET combined [CONCAT $list1 $list2 $list3]
PUTS $combined  # 1 2 3 4 5 6 7 8 9
\end{lstlisting}
\end{examplebox}

\section{Practical Examples}

\subsection{Shopping List Manager}

\begin{examplebox}[title=Shopping List]
\begin{lstlisting}[language=BCL]
SET shopping_list [LIST]

PROC add_item WITH item DO
  GLOBAL shopping_list
  LAPPEND shopping_list $item
  PUTS "Added: $item"
END

PROC show_list DO
  GLOBAL shopping_list
  SET count [LLENGTH $shopping_list]

  IF $count == 0 THEN
    PUTS "Shopping list is empty"
    RETURN
  END

  PUTS "Shopping List ($count items):"
  SET i 0
  FOREACH item IN $shopping_list DO
    INCR i
    PUTS "  $i. $item"
  END
END

add_item "Milk"
add_item "Bread"
add_item "Eggs"
show_list
\end{lstlisting}

\textbf{Output:}
\begin{verbatim}
Added: Milk
Added: Bread
Added: Eggs
Shopping List (3 items):
  1. Milk
  2. Bread
  3. Eggs
\end{verbatim}
\end{examplebox}

\subsection{Grade Calculator}

\begin{examplebox}[title=Calculate Average Grade]
\begin{lstlisting}[language=BCL]
SET grades [LIST 85 92 78 90 88 95]

# Calculate sum
SET sum 0
FOREACH grade IN $grades DO
  SET sum [EXPR $sum + $grade]
END

# Calculate average
SET count [LLENGTH $grades]
SET average [EXPR $sum / $count]

# Find min and max
SET sorted [LSORT $grades]
SET min [LINDEX $sorted 0]
SET max [LINDEX $sorted [EXPR $count - 1]]

PUTS [FORMAT "Count: %d" $count]
PUTS [FORMAT "Average: %.2f" $average]
PUTS [FORMAT "Minimum: %d" $min]
PUTS [FORMAT "Maximum: %d" $max]
\end{lstlisting}

\textbf{Output:}
\begin{verbatim}
Count: 6
Average: 88.00
Minimum: 78
Maximum: 95
\end{verbatim}
\end{examplebox}

% Continue with remaining chapters following same format...
% Due to space, I'll include chapter headers and key sections
